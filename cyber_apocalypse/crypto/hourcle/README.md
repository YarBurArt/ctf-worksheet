# Hourcle

–ü–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–æ: `rasti`

–ê–≤—Ç–æ—Ä –∑–∞–¥–∞–Ω–∏—è: `rasti`

–£—Ä–æ–≤–µ–Ω—å —Å–ª–æ–∂–Ω–æ—Å—Ç–∏: –õ–µ–≥–∫–æ

## –û–ø–∏—Å–∞–Ω–∏–µ 

- –ú–æ–≥—É—á–µ–µ –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–µ, —Å–æ–∑–¥–∞–Ω–Ω–æ–µ —á—Ç–æ–±—ã —Å–∫—Ä—ã–≤–∞—Ç—å, –Ω–µ–±—Ä–µ–∂–Ω–æ –±—ã–ª–æ –ø–µ—Ä–µ–æ—Å–º—ã—Å–ª–µ–Ω–æ –∏ —Ç–µ–ø–µ—Ä—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –±–æ–ª—å—à–µ, —á–µ–º —Å–∫—Ä—ã–≤–∞–µ—Ç. –î—É—Ä–∞–∫ –∏—Å–∫–∞–ª –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, –Ω–æ —Å–æ–∑–¥–∞–ª –ø—Ä–æ—Ö–æ–¥ –¥–ª—è —Ç–µ—Ö, –∫—Ç–æ –æ—Å–º–µ–ª–∏—Ç—Å—è –∑–∞–≥–ª—è–Ω—É—Ç—å –∑–∞ –ø—Ä–µ–¥–µ–ª—ã –∏–ª–ª—é–∑–∏–∏. –°–º–æ–∂–µ—à—å –ª–∏ —Ç—ã –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Å–∞–º–∏–º –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–µ–º, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–º –¥–ª—è –∑–∞—â–∏—Ç—ã —Å–≤–æ–∏—Ö —Ç–∞–π–Ω, –∏ –æ–±—Ä–∞—Ç–∏—Ç—å –µ–≥–æ –≤ —Å–≤–æ—é –≤–æ–ª—é?

–í —Ç–∞—Å–∫–µ –¥–∞–Ω–æ —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ñ–∞–π–ª:
- `server.py` —Å—Ä–∞–±–∞—Ç—ã–≤–µ—Ç –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ —á–µ—Ä–µ–∑ —É—Ç–∏–ª–∏—Ç—ã —Ç–∏–ø–∞ nc, –æ—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è, –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏ —á—Ç–µ–Ω–∏—è —Ñ–ª–∞–≥–∞

## –ê–Ω–∞–ª–∏–∑ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∫–æ–¥–∞

```python
def show_menu():
    return input('''
=========================================
||                                     ||
||   üè∞ –¢–µ–Ω–µ–≤–∞—è –ö—Ä–µ–ø–æ—Å—Ç—å –≠–ª—å–¥–æ—Ä–∏–∏ üè∞  ||
||                                     ||
||  [1] –ó–∞–ø–µ—á–∞—Ç–∞–π —Å–≤–æ—ë –∏–º—è –≤ –ê—Ä—Ö–∏–≤–∞—Ö   ||
||  [2] –í–æ–π–¥–∏ –≤ –ó–∞–ø—Ä–µ—Ç–Ω–æ–µ –°–≤—è—Ç–∏–ª–∏—â–µ    ||
||  [3] –ü–æ–∫–∏–Ω—å –¶–∞—Ä—Å—Ç–≤–æ                 ||
||                                     ||
=========================================

–í—ã–±–µ—Ä–∏ —Å–≤–æ–π –ø—É—Ç—å, –ø—É—Ç–µ—à–µ—Å—Ç–≤–µ–Ω–Ω–∏–∫ :: ''')

def main():
    while True:
        ch = show_menu()
        print()
        if ch == '1':
            username = input('[+] –ü—Ä–æ–∏–∑–Ω–µ—Å–∏ —Å–≤–æ—ë –∏–º—è, —á—Ç–æ–±—ã –æ–Ω–æ –±—ã–ª–æ –∑–∞–ø–µ—á–∞—Ç–∞–Ω–æ –≤ –∞—Ä—Ö–∏–≤–∞—Ö :: ')
            pattern = re.compile(r"^[\w]{16,}$")
            if not pattern.match(username):
                print('[-] –î—Ä–µ–≤–Ω–∏–µ –ø–∏—Å—Ü—ã –ø—Ä–∏–Ω–∏–º–∞—é—Ç —Ç–æ–ª—å–∫–æ –Ω–∞–¥–ª–µ–∂–∞—â–∏–µ –∏–º–µ–Ω–∞-–∑–∞–ø—Ä–µ—â—ë–Ω–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã –Ω–µ –¥–æ–ø—É—Å–∫–∞—é—Ç—Å—è.')
                continue
            encrypted_creds = encrypt_creds(username)
            print(f'[+] –¢–≤–æ–∏ —É—á—ë—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –±—ã–ª–∏ –∑–∞–ø–µ—á–∞—Ç–∞–Ω—ã –≤ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–≤–∏—Ç–∫–∞—Ö: {encrypted_creds.hex()}')
        elif ch == '2':
            pwd = input('[+] –®–µ–ø–Ω–∏ —Å–≤—è—â–µ–Ω–Ω–æ–µ –∑–∞–∫–ª–∏–Ω–∞–Ω–∏–µ, —á—Ç–æ–±—ã –≤–æ–π—Ç–∏ –≤ –ó–∞–ø—Ä–µ—Ç–Ω–æ–µ –°–≤—è—Ç–∏–ª–∏—â–µ :: ')
            if admin_login(pwd):
                print(f"[+] –í—Ä–∞—Ç–∞ –æ—Ç–∫—Ä—ã–≤–∞—é—Ç—Å—è –ø–µ—Ä–µ–¥ —Ç–æ–±–æ–π, –•—Ä–∞–Ω–∏—Ç–µ–ª—å –¢–∞–π–Ω! {open('flag.txt').read()}")
                exit()
            else:
                print('[-] –¢—ã –Ω–µ –ø—Ä–æ–π–¥—ë—à—å!')
        elif ch == '3':
            print('[+] –¢—ã –æ—Ç–≤–æ—Ä–∞—á–∏–≤–∞–µ—à—å—Å—è –æ—Ç —Ç–µ–Ω–µ–π –∏ —Ä–∞—Å—Ç–≤–æ—Ä—è–µ—à—å—Å—è –≤ —Ç—É–º–∞–Ω–µ...')
            exit()
        else:
            print('[-] –û—Ä–∞–∫—É–ª –Ω–µ –ø–æ–Ω–∏–º–∞–µ—Ç —Ç–≤–æ–∏—Ö —Å–ª–æ–≤.')

```

–£ –Ω–∞—Å –µ—Å—Ç—å —Ç—Ä–∏ –≤–∞—Ä–∏–∞–Ω—Ç–∞:
- –Ω–∞–ø–∏—Å–∞—Ç—å –∏–º—è, —Å–µ—Ä–≤–µ—Ä –µ–≥–æ –∑–∞—à–∏—Ñ—Ä—É–µ—Ç –≤–º–µ—Å—Ç–µ —Å –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω—ã–º –ø–∞—Ä–æ–ª–µ–º –∏ –≤–µ—Ä–Ω–µ—Ç –≤ —Ö–µ–∫—Å–∞—Ö, –Ω–æ –∏–º—è –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ—Ç 16 —Å–∏–º–≤–æ–ª–æ–≤ –∏–∑ –∑–∞ –ø–∞–¥–¥–∏–Ω–≥–∞ —à–∏—Ñ—Ä–∞
- –Ω–∞–ø–∏—Å–∞—Ç—å –ø–∞—Ä–æ–ª—å, –∏ –µ—Å–ª–∏ –≤–µ—Ä–Ω—ã–π –º—ã –ø–æ–ª—É—á–∏–º —Ñ–ª–∞–≥
- –ø—Ä–æ—Å—Ç–æ –≤—ã–π—Ç–∏

–ü–æ—Å–º–æ—Ç—Ä–∏–º –∫–∞–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —à–∏—Ñ—Ä—É–µ—Ç –∏–º—è –∏ –ø–∞—Ä–æ–ª—å –∏–∑ –ø–µ—Ä–≤–æ–≥–æ –≤–∞—Ä–∏–∞–Ω—Ç–∞ 
```python
import os, random, string
from Crypto.Cipher import AES
from Crypto.Util.Padding import pad

KEY = os.urandom(32)

password = ''.join(
    [random.choice(string.ascii_letters+string.digits)
     for _ in range(57)]
)

def encrypt_creds(user):
    padded = pad((user + password).encode(), 16)
    IV = os.urandom(16)
    cipher = AES.new(KEY, AES.MODE_CBC, iv=IV)
    ciphertext = cipher.decrypt(padded)
    return ciphertext
```

–ó–¥–µ—Å—å –≤–∏–¥–Ω–æ, —á—Ç–æ –∫–ª—é—á –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω—ã–π –≤ `KEY`, –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—Ä–∞–∑—É –¥–ª—è –≤—Å–µ—Ö –ø–∞—Ä –∫—Ä–µ–¥, —á—Ç–æ —É–∂–µ —Å—Ç—Ä–∞–Ω–Ω–æ. –ë–æ–ª–µ–µ —Ç–æ–≥–æ, —à–∏—Ñ—Ä –Ω–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π, –∏—Å–ø–æ–ª—å–∑—É—é—Ç AES –≤ —Ä–µ–∂–∏–º–µ CBC —á–µ—Ä–µ–∑ –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —á–∏—Å—Ç–æ–≥–æ —Ç–µ–∫—Å—Ç–∞.

## –†–µ—à–µ–Ω–∏–µ

–û—Å–Ω–æ–≤—ã –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ AES CBC

![](https://raw.githubusercontent.com/hackthebox/cyber-apocalypse-2025/refs/heads/main/crypto/hourcle/assets/aes-cbc.png)

–î–ª—è –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è, —à–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç –∏ –∏—Å—Ö–æ–¥–Ω—ã–π —Ç–µ–∫—Å –ø–æ–º–µ–Ω—è–Ω—ã –º–µ—Å—Ç–∞–º–∏.

–ú–æ–∂–Ω–æ –∑–∞–º–µ—Ç–∏—Ç—å, —á—Ç–æ –¥–ª—è –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö –±–ª–æ–∫–æ–≤ –æ—Ç–∫—Ä—ã—Ç–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –¥–∞—ë—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –±–ª–æ–∫–∏. –≠—Ç–æ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å AES-ECB –∏ –ø—Ä–∏—á–∏–Ω–∞, –ø–æ –∫–æ—Ç–æ—Ä–æ–π –µ–≥–æ –∏–∑–±–µ–≥–∞—é—Ç –¥–ª—è –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏–∏. –•–æ—Ç—è –≤ —ç—Ç–æ–π –∑–∞–¥–∞—á–µ AES –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —Ä–µ–∂–∏–º–µ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è CBC, —á—Ç–æ –æ—Å–æ–±–æ –Ω–µ –º–µ–Ω—è–µ—Ç —Å–∞–º –ø—Ä–æ—Ü–µ—Å—Å —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏–∏.

–ó–Ω–∞—è –≤–µ–∫—Ç–æ—Ä –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏, –º—ã –º–æ–∂–µ–º –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—é –æ—Ä–∞–∫—É–ª–∞ AES-CBC. –ü–æ—Å–ª–µ –Ω–µ–±–æ–ª—å—à–æ–≥–æ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è –≤ —Å–µ—Ç–∏ –Ω–∞—Ç–∫–Ω—ë—à—å—Å—è –Ω–∞ —Ç–∞–∫ –Ω–∞–∑—ã–≤–∞–µ–º—É—é –∞—Ç–∞–∫—É –æ—Ä–∞–∫—É–ª–∞ AES-ECB [–æ—Ä–∏–≥–∏–Ω–∞–ª](https://www.ctfrecipes.com/cryptography/symmetric-cryptography/aes/mode-of-operation/ecb/ecb-oracle#exploitation) , —Å—Ç–∞—Ç—å–∏ –Ω–∞ —Ä—É—Å—Å–∫–æ–º [AES-ECB oracle](https://habr.com/ru/articles/855906/) –∏ [AES-CBC oracle](https://habr.com/ru/articles/247527/) . –û–±–µ —ç—Ç–∏ —Ç–µ—Ö–Ω–∏–∫–∏ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ CTF.

–ü—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –æ—Ä–∞–∫—É–ª, –∫–æ—Ç–æ—Ä—ã–π —à–∏—Ñ—Ä—É–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –≤–∏–¥–∞ user_input || secret. –°–µ–∫—Ä–µ—Ç –æ—Å—Ç–∞—ë—Ç—Å—è —Ç–µ–º –∂–µ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –≤—ã–∑–æ–≤–∞ –æ—Ä–∞–∫—É–ª–∞ –∏ –ø—É—Å—Ç—å —ç—Ç–æ 16-–±–∞–π—Ç–æ–≤—ã–π –ø–∞—Ä–æ–ª—å. –¢–æ–≥–¥–∞ –µ—Å–ª–∏ –º—ã –æ—Ç–ø—Ä–∞–≤–∏–º –≤–≤–æ–¥ –¥–ª–∏–Ω–æ–π 15 –±–∞–π—Ç, –±–ª–æ–∫–∏ –±—É–¥—É—Ç —Ä–∞–∑–¥–µ–ª–µ–Ω—ã —Ç–∞–∫:

```
Block 0 : AAAAAAAAAAAAAAAx
Block 1 : xxxxxxxxxxxxxxxx
Block 2 : pppppppppppppppp
```

–≥–¥–µ A —ç—Ç–æ –Ω–∞—à–∏ –±–∞–π—Ç—ã –≤–≤–æ–¥–∞, x —ç—Ç–æ –ª—é–±—ã–µ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–µ –±–∞–π—Ç—ã –ø–∞—Ä–æ–ª—è, –∞ p —ç—Ç–æ –±–∞–π—Ç—ã –ø–∞–¥–¥–∏–Ω–≥–∞ –∏ –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏—è. –°–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ:

- Block 0 : –º—ã –∑–Ω–∞–µ–º –≤—Å—ë, **–∫—Ä–æ–º–µ** –æ–¥–Ω–æ–≥–æ –±–∞–π—Ç–∞
- Block 1 : –º—ã –Ω–∏—á–µ–≥–æ –Ω–µ –∑–Ω–∞–µ–º
- Block 2 : –º—ã –∑–Ω–∞–µ–º –≤–µ—Å—å –±–ª–æ–∫

–•–æ—Ç—è –ø–æ—Å–ª–µ–¥–Ω–∏–π –±–∞–π—Ç Block 0 –Ω–µ–∏–∑–≤–µ—Å—Ç–µ–Ω, –æ–±—â–µ–∏–∑–≤–µ—Å—Ç–Ω–æ, —á—Ç–æ –ø–∞—Ä–æ–ª—å —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –±—É–∫–≤–µ–Ω–Ω–æ-—Ü–∏—Ñ—Ä–æ–≤—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤, –ø–æ—ç—Ç–æ–º—É –µ–≥–æ —Ç—Ä–∏–≤–∏–∞–ª—å–Ω–æ –ø–æ–¥–æ–±—Ä–∞—Ç—å –±—Ä—É—Ç–æ–º. –°–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, –º–æ–∂–Ω–æ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å 15 –±–∞–π—Ç –∏ –ø–µ—Ä–µ–±—Ä–∞—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π –±–∞–π—Ç –ø–µ—Ä–≤–æ–≥–æ –±–ª–æ–∫–∞ –∫–∞–∫:

```
Block 0 : AAAAAAAAAAAAAAA?
```

–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –±–∞–π—Ç —Å–æ–≤–ø–∞–¥—ë—Ç —Å –∏—Å—Ö–æ–¥–Ω—ã–º —à–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç–æ–º –¥–ª—è `AAAAAAAAAAAAAAAx`.

–ò–º–µ—è –ø–µ—Ä–≤—ã–π –±–∞–π—Ç –ø–∞—Ä–æ–ª—è, –º–æ–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å 14 –±–∞–π—Ç –≤—Ö–æ–¥–∞ + –Ω–∞–π–¥–µ–Ω–Ω—ã–π –±–∞–π—Ç –ø–∞—Ä–æ–ª—è + –ø–µ—Ä–µ–±—Ä–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–π –±–∞–π—Ç –ø–∞—Ä–æ–ª—è:

```
Block 0 : AAAAAAAAAAAAAAx?
```

–í –Ω–∞—à–µ–π –∑–∞–¥–∞—á–µ –Ω–µ–ª—å–∑—è –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∫–æ—Ä–æ—á–µ 16 –±–∞–π—Ç, –ø–æ—ç—Ç–æ–º—É –Ω—É–∂–Ω–æ –Ω–∞—á–∏–Ω–∞—Ç—å —Å Block 1, –∞ –Ω–µ —Å Block 0. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –º—ã –Ω–∞—á–∏–Ω–∞–µ–º —Å –æ—Ç–ø—Ä–∞–≤–∫–∏ 31 –±–∞–π—Ç–∞ –≤–≤–æ–¥–∞ + 1 –ø–µ—Ä–µ–±–∏—Ä–∞–µ–º—ã–π –±–∞–π—Ç –∏ –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º —Ç–µ–º –∂–µ –º–µ—Ç–æ–¥–æ–º.

–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∞—Ç–∞–∫–∏ 
```python
import string

alph = string.ascii_letters + string.digits
password = ''
block_num = 1

while len(password) < 57:
  	# –ø—Ä–µ—Ñ–∏–∫—Å —Å–∏–º–≤–æ–ª–æ–≤ –≤–≤–æ–¥–∞ –∏—Å—Ö–æ–¥–Ω–∏–∫–∞
    plaintext = 'x' * ((block_num+1) * 16 - 1 - len(password))
    # –ø–æ–ª—É—á–∏—Ç—å —Ü–µ–ª–µ–≤–æ–π —à–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç, —Å –∫–æ—Ç–æ—Ä—ã–º –º—ã –º–æ–∂–µ–º –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–±–æ—Ä–∞ —Ç–µ–∫—É—â–µ–≥–æ –±–∞–π—Ç–∞
    target_ct = encrypt(plaintext)
    current_target_ct_block = _b(target_ct)[block_num]
		
    # –ø–µ—Ä–µ–±–æ—Ä –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –ø–æ –∞–ª—Ñ–∞–≤–∏—Ç—É
    for c in alph:
      	# send : input || password || ?
        pt = (plaintext + password + c).encode()
        current_test_ct_blocks = _b(encrypt(pt))

        if current_test_ct_blocks[block_num] == current_target_ct_block:
            password += c
            # –µ—Å–ª–∏ –±–ª–æ–∫ –∑–∞–ø–æ–ª–Ω–µ–Ω, –ø–µ—Ä–µ–º–µ—â–∞–µ–º—Å—è –∫ —Å–ª–µ–¥—É—é—â–µ–º—É
            if len(password) % 16 == 0:
                block_num += 1
            print(password)
            break
    else:
        print(f'–æ—à–∏–±–∫–∞ –≤ –±–ª–æ–∫–µ {block_num}')
        exit()
```

–ò –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ñ–ª–∞–≥–∞
```python
# ... –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ pwntools
def admin_login(pwd):
    io.sendlineafter(b'traveler :: ', b'2')
    io.sendlineafter(b'Sanctum :: ', pwd.encode())
    resp = io.recvline().decode().strip()
    return re.findall(r'HTB{.+}', resp)[0]

print(admin_login(password))
```