# Kewiri

–ü–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–æ:`rasti`

–ê–≤—Ç–æ—Ä –∑–∞–¥–∞–Ω–∏—è:`rasti`

–£—Ä–æ–≤–µ–Ω—å —Å–ª–æ–∂–Ω–æ—Å—Ç–∏: –û—á–µ–Ω—å –ª–µ–≥–∫–æ

## –û–ø–∏—Å–∞–Ω–∏–µ 
- –í–µ–ª–∏–∫–∏–µ —É—á—ë–Ω—ã–µ –≠–ª–¥–æ—Ä–∏–∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∏–ª–∏ —Å–µ—Ä–∏—é –∏—Å–ø—ã—Ç–∞–Ω–∏–π, –∫–∞–∂–¥–æ–µ –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö –ø—Ä–æ–≤–µ—Ä–∏—Ç –≥–ª—É–±–∏–Ω—É –≤–∞—à–µ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è –¥—Ä–µ–≤–Ω–∏—Ö –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –∏—Å–∫—É—Å—Å—Ç–≤. –¢–µ–º, –∫—Ç–æ –æ—Ç–≤–µ—Ç–∏—Ç –º—É–¥—Ä–æ, –±—É–¥–µ—Ç –¥–∞—Ä–æ–≤–∞–Ω–æ –ø—Ä–æ–∑—Ä–µ–Ω–∏–µ, –∞ –Ω–µ–¥–æ—Å—Ç–æ–π–Ω—ã–µ –±—É–¥—É—Ç –Ω–∏–∑–≤–µ—Ä–≥–Ω—É—Ç—ã –≤ –ø—É—á–∏–Ω—É –Ω–µ–≤–µ–∂–µ—Å—Ç–≤–∞. –ü—Ä–∏–º–∏—Ç–µ –ª–∏ –≤—ã –≤—ã–∑–æ–≤, –∏–ª–∏ –≤–∞—à —Ä–∞–∑—É–º –¥—Ä–æ–≥–Ω–µ—Ç –ø–æ–¥ —Ç—è–∂–µ—Å—Ç—å—é –∑–∞–±—ã—Ç—ã—Ö –∑–Ω–∞–Ω–∏–π?

## –í–æ–ø—Ä–æ—Å 1

–ü—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –∫ —ç–∫–∑–µ–º–ø–ª—è—Ä—É (server.py , –Ω–æ –≤ —Ç–∞—Å–∫–µ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —á–∏—Å–ª–∞ p) –º—ã –∂–¥—ë–º –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ–∫—É–Ω–¥, –ø–æ–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è —Å—Ä–µ–¥–∞, –∞ –∑–∞—Ç–µ–º –Ω–∞–º –∑–∞–¥–∞—é—Ç –ø–µ—Ä–≤—ã–π –≤–æ–ø—Ä–æ—Å. –û–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è, —É –Ω–∞—Å –µ—Å—Ç—å –≤—Å–µ–≥–æ –¥–≤–µ —Å–µ–∫—É–Ω–¥—ã, —á—Ç–æ–±—ã –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –∫–∞–∂–¥—ã–π –≤–æ–ø—Ä–æ—Å, –∏–Ω–∞—á–µ –º—ã –ø–æ–ª—É—á–∏–º Too slow... –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –≤–æ–∑–º–æ–∂–Ω–∞ —á–µ—Ä–µ–∑ pwntools.


```py
[!] The ancient texts are being prepared...
You have entered the Grand Archives of Eldoria! The scholars shall test your wisdom. Answer their questions to prove your worth and claim the hidden knowledge.
You are given the sacred prime: p = 21214334341047589034959795830530169972304000967355896041112297190770972306665257150126981587914335537556050020788061
[1] How many bits is the prime p? >
```

```py
[!] –î—Ä–µ–≤–Ω–∏–µ —Ç–µ–∫—Å—Ç—ã –≥–æ—Ç–æ–≤—è—Ç—Å—è... –í—ã –≤–æ—à–ª–∏ –≤ –í–µ–ª–∏–∫–∏–µ –ê—Ä—Ö–∏–≤—ã –≠–ª—å–¥–æ—Ä–∏–∏! –£—á–µ–Ω—ã–µ –±—É–¥—É—Ç –∏—Å–ø—ã—Ç—ã–≤–∞—Ç—å –≤–∞—à—É –º—É–¥—Ä–æ—Å—Ç—å. –û—Ç–≤–µ—Ç—å—Ç–µ –Ω–∞ –∏—Ö –≤–æ–ø—Ä–æ—Å—ã, —á—Ç–æ–±—ã –¥–æ–∫–∞–∑–∞—Ç—å —Å–≤–æ—é —Ü–µ–Ω–Ω–æ—Å—Ç—å –∏ –ø–æ–ª—É—á–∏—Ç—å —Å–∫—Ä—ã—Ç–æ–µ –∑–Ω–∞–Ω–∏–µ.
–í–∞–º –≤—Ä—É—á–∞–µ—Ç—Å—è —Å–≤—è—â–µ–Ω–Ω–æ–µ –ø—Ä–æ—Å—Ç–æ–µ —á–∏—Å–ª–æ: p = 21214334341047589034959795830530169972304000967355896041112297190770972306665257150126981587914335537556050020788061
[1] –ù–∞—Å–∫–æ–ª—å–∫–æ –º–Ω–æ–≥–æ –±–∏—Ç –≤ –ø—Ä–æ—Å—Ç–æ–º —á–∏—Å–ª–µ p? >
```

## –†–µ—à–µ–Ω–∏–µ 1 

–û—Ç–∫—Ä—ã–≤–∞–µ–º –æ–±–æ–ª–æ—á–∫—É python –ª–∏–±–æ [sage](https://doc.sagemath.org/html/ru/tutorial/interactive_shell.html) –∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º –º–µ—Ç–æ–¥ bit_length()
```python
p = 21214334341047589034959795830530169972304000967355896041112297190770972306665257150126981587914335537556050020788061
print(p.bit_length())
```

## –í–æ–ø—Ä–æ—Å 2

```txt
...
[2] Enter the full factorization of finite field F_p in ascending order of factors (format: p0,e0_p1,e1_ ..., where pi are the distinct factors and ei the multiplicities of each factor) 
```
```txt
[2] –í–≤–µ–¥–∏—Ç–µ –ø–æ–ª–Ω—É—é —Ñ–∞–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –º—É–ª—å—Ç–∏–ø–ª–∏–∫–∞—Ç–∏–≤–Ω–æ–π –≥—Ä—É–ø–ø—ã –∫–æ–Ω–µ—á–Ω–æ–≥–æ –ø–æ–ª—è F_p –≤ –ø–æ—Ä—è–¥–∫–µ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—è –º–Ω–æ–∂–∏—Ç–µ–ª–µ–π (—Ñ–æ—Ä–º–∞—Ç: p0,e0_p1,e1_ ..., –≥–¥–µ pi ‚Äî —Ä–∞–∑–ª–∏—á–Ω—ã–µ –ø—Ä–æ—Å—Ç—ã–µ –º–Ω–æ–∂–∏—Ç–µ–ª–∏, –∞ ei ‚Äî –∫—Ä–∞—Ç–Ω–æ—Å—Ç–∏ –∫–∞–∂–¥–æ–≥–æ –º–Ω–æ–∂–∏—Ç–µ–ª—è) >
```


## –†–µ—à–µ–Ω–∏–µ 2

–ß—Ç–æ–±—ã –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ —ç—Ç–æ, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å [SageMath](https://doc.sagemath.org/html/ru/tutorial/index.html) –∏–ª–∏ –ª—é–±–æ–π –æ–Ω–ª–∞–π–Ω‚Äë—Å–µ—Ä–≤–∏—Å —Ñ–∞–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä factordb. –í —ç—Ç–æ–º –ø–æ—è—Å–Ω–µ–Ω–∏–∏ –º—ã –ø–æ–∫–∞–∂–µ–º SageMath –≤ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —Ü–µ–ª—è—Ö. –í Sage –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–µ –∫–æ–Ω–µ—á–Ω–æ–µ –ø–æ–ª–µ –∑–∞–¥–∞—ë—Ç—Å—è –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–æ–º `GF`. –í–∞–∂–Ω—ã–π —Ñ–∞–∫—Ç: –ø–æ—Ä—è–¥–æ–∫ –º—É–ª—å—Ç–∏–ø–ª–∏–∫–∞—Ç–∏–≤–Ω–æ–π –≥—Ä—É–ø–ø—ã –∫–æ–Ω–µ—á–Ω–æ–≥–æ –ø–æ–ª—è –Ω–∞–¥ –ø—Ä–æ—Å—Ç—ã–º p —Ä–∞–≤–µ–Ω p-1. –°–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, –∑–∞–¥–∞—á–∞ —Å–≤–æ–¥–∏—Ç—Å—è –∫ —Ñ–∞–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ p-1. GF —ç—Ç–æ –∫–ª–∞—Å—Å –∫–æ–Ω–µ—á–Ω–æ–≥–æ –ø–æ–ª—è –Ω–∞–¥ p.

```python
F = GF(p)
print(factor(p-1))
```

## –í–æ–ø—Ä–æ—Å 3

```txt
> [3] For this question, you will have to send 1 if the element is a generator of the finite field F_p, otherwise 0.
```

```txt
[3] –î–ª—è —ç—Ç–æ–≥–æ –≤–æ–ø—Ä–æ—Å–∞ –Ω—É–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å 1, –µ—Å–ª–∏ —ç–ª–µ–º–µ–Ω—Ç —è–≤–ª—è–µ—Ç—Å—è –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–æ–º –∫–æ–Ω–µ—á–Ω–æ–≥–æ –ø–æ–ª—è F_p, –∏–Ω–∞—á–µ 0. >
```

## –†–µ—à–µ–Ω–∏–µ 3

–ü–æ—Ö–æ–∂–µ –Ω–∞ –∑–∞–¥–∞—á—É –ø–æ–∏—Å–∫–∞ —Ä–µ—à–µ–Ω–∏—è. –ù–∞–º –±—É–¥—É—Ç –¥–∞–Ω—ã –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ü–µ–ª—ã—Ö —á–∏—Å–µ–ª, –∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, —è–≤–ª—è—é—Ç—Å—è –ª–∏ –æ–Ω–∏ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞–º–∏, –∑–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è.

–û—Ç–Ω—ã–Ω–µ –º—ã –±—É–¥–µ–º —Å—Å—ã–ª–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ –º—É–ª—å—Ç–∏–ø–ª–∏–∫–∞—Ç–∏–≤–Ω—É—é –≥—Ä—É–ø–ø—É –∫–æ–Ω–µ—á–Ω–æ–≥–æ –ø–æ–ª—è F_p. –°–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, –æ–ø–µ—Ä–∞—Ü–∏—è –≤ –≥—Ä—É–ø–ø–µ ‚Äî —É–º–Ω–æ–∂–µ–Ω–∏–µ, –∞ –Ω–µ —Å–ª–æ–∂–µ–Ω–∏–µ.

–ù–∞–ø–æ–º–Ω–∏–º, —á—Ç–æ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä g ‚àà F_p ‚Äî —ç—Ç–æ —ç–ª–µ–º–µ–Ω—Ç –ø–æ—Ä—è–¥–∫–∞ p-1; —Ç–æ –µ—Å—Ç—å –Ω–∞–∏–º–µ–Ω—å—à–µ–µ —Ü–µ–ª–æ–µ k —Ç–∞–∫–æ–µ, —á—Ç–æ g^k ‚â° 1, —Ä–∞–≤–Ω–æ p-1. –ü—Ä–æ—â–µ –≥–æ–≤–æ—Ä—è, –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–º–∏ –≤–æ–∑–≤–µ–¥–µ–Ω–∏—è–º–∏ –≤ —Å—Ç–µ–ø–µ–Ω–∏ –æ–Ω –ø–æ—Ä–æ–∂–¥–∞–µ—Ç –≤—Å—é –≥—Ä—É–ø–ø—É. –°—É—â–µ—Å—Ç–≤—É—é—Ç —Ä–∞–∑–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã; –Ω–∞–∏–≤–Ω—ã–π ‚Äî –ø–µ—Ä–µ—á–∏—Å–ª—è—Ç—å –≤—Å–µ —Å—Ç–µ–ø–µ–Ω–∏ g^1, g^2, ..., g^k –¥–æ –ø–æ—è–≤–ª–µ–Ω–∏—è 1. –ù–æ –¥–ª—è —Å—Ç–æ–ª—å –±–æ–ª—å—à–∏—Ö p —ç—Ç–æ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –Ω–µ–≤—ã–ø–æ–ª–Ω–∏–º–æ, –ø–æ—ç—Ç–æ–º—É –Ω—É–∂–µ–Ω –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –º–µ—Ç–æ–¥. –ó–¥–µ—Å—å –ø–æ–ª–µ–∑–Ω–∞ —Ç–µ–æ—Ä–µ–º–∞ –õ–∞–≥—Ä–∞–Ω–∂–∞. –û–Ω–∞ –≥–ª–∞—Å–∏—Ç:

> –ü—É—Å—Ç—å G ‚Äî –≥—Ä—É–ø–ø–∞ –∏ a ‚àà G. –ü–æ—Ä—è–¥–æ–∫ —ç–ª–µ–º–µ–Ω—Ç–∞ a –¥–µ–ª–∏—Ç –ø–æ—Ä—è–¥–æ–∫ –≥—Ä—É–ø–ø—ã G.

–û—Ç–≤–µ—Ç—ã, —Ç–∞–∫–∏–µ –∫–∞–∫ [1] –∏ [2], –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç, –∫–∞–∫ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç—É —Ç–µ–æ—Ä–µ–º—É –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —ç–ª–µ–º–µ–Ω—Ç –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–æ–º. –û—Å–Ω–æ–≤–Ω–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å ‚Äî —Ñ–∞–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è p-1, –∫–æ—Ç–æ—Ä—É—é –º—ã —É–∂–µ –∑–Ω–∞–µ–º –∏–∑ –≤–æ–ø—Ä–æ—Å–∞ (2).

–°–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ, –º–æ–∂–Ω–æ –∑–∞–ø–∏—Å–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–π –º–µ—Ç–æ–¥ –ø—Ä–æ–≤–µ—Ä–∫–∏, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —ç–ª–µ–º–µ–Ω—Ç g –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–æ–º –ø–æ–ª—è 
```math
\forall f \in \text{–ø—Ä–æ—Å—Ç—ã–µ –º–Ω–æ–∂–∏—Ç–µ–ª–∏}(p-1): 
\left(g^{\frac{p-1}{f}} \mod p \neq 1 \text{ –∏–ª–∏ } f = p-1\right)
```

```python
def is_generator(g):
		p_1_factors = list(factor(p-1))
    for f,_ in p_1_factors:
      	# –∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º –º—É–ª—å—Ç–∏–ø–ª–∏–∫–∞—Ç–∏–≤–Ω–æ—Å—Ç—å
        # –≤–∞–∂–Ω—ã —Ç–æ–ª—å–∫–æ –ø—Ä–æ—Å—Ç—ã–µ –º–Ω–æ–∂–∏—Ç–µ–ª–∏ 
        if pow(g, (p-1)//f, p) == 1 and f != p-1:
            # g —è–≤–ª—è–µ—Ç—Å—è –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–æ–º –ø–æ–ª—è 
            return False
		return True
```

## –í–æ–ø—Ä–æ—Å 4
```py
> The scholars present a sacred mathematical construct, a curve used to protect the most guarded secrets of the realm. Only those who understand its nature may proceed.
> a = 408179155510362278173926919850986501979230710105776636663982077437889191180248733396157541580929479690947601351140
> b = 8133402404274856939573884604662224089841681915139687661374894548183248327840533912259514444213329514848143976390134
> [4] What is the order of the curve defined over F_p? > 
```
–ü–µ—Ä–≤—ã–µ —Ç—Ä–∏ –≤–æ–ø—Ä–æ—Å–∞ –∫–∞—Å–∞–ª–∏—Å—å –∫–æ–Ω–µ—á–Ω—ã—Ö –ø–æ–ª–µ–π –ø—Ä–æ—Å—Ç–æ–≥–æ –ø–æ—Ä—è–¥–∫–∞, –æ–±–æ–∑–Ω–∞—á–∞–µ–º—ã—Ö –∫–∞–∫ $\mathbb{F}_p$. –°–ª–µ–¥—É—é—â–∏–µ —Ç—Ä–∏ –≤–æ–ø—Ä–æ—Å–∞ ‚Äî –æ–± —ç–ª–ª–∏–ø—Ç–∏—á–µ—Å–∫–∏—Ö –∫—Ä–∏–≤—ã—Ö, –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö –Ω–∞–¥ –ø—Ä–æ—Å—Ç—ã–º–∏ –∫–æ–Ω–µ—á–Ω—ã–º–∏ –ø–æ–ª—è–º–∏, –æ–±–æ–∑–Ω–∞—á–∞–µ–º—ã–º–∏ $\mathbb{F}_p$.
```py
> –£—á—ë–Ω—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç —Å–≤—è—â–µ–Ω–Ω—É—é –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫—É—é –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—é ‚Äî –∫—Ä–∏–≤—É—é, –∏—Å–ø–æ–ª—å–∑—É–µ–º—É—é –¥–ª—è –æ—Ö—Ä–∞–Ω—ã —Å–∞–º—ã—Ö –æ—Ö—Ä–∞–Ω—è–µ–º—ã—Ö —Ç–∞–π–Ω –∫–æ—Ä–æ–ª–µ–≤—Å—Ç–≤–∞. –¢–æ–ª—å–∫–æ —Ç–µ, –∫—Ç–æ –ø–æ–Ω–∏–º–∞–µ—Ç –µ—ë –ø—Ä–∏—Ä–æ–¥—É, –º–æ–≥—É—Ç –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å.  
> a = 408179155510362278173926919850986501979230710105776636663982077437889191180248733396157541580929479690947601351140
> b = 8133402404274856939573884604662224089841681915139687661374894548183248327840533912259514444213329514848143976390134
> [4] –ö–∞–∫–æ–≤ –ø–æ—Ä—è–¥–æ–∫ –∫—Ä–∏–≤–æ–π, –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–π –Ω–∞–¥ F_p?
```

## –†–µ—à–µ–Ω–∏–µ 4

–û–ø—è—Ç—å –∂–µ, —Å –ø–æ–º–æ—â—å—é SageMath –º–æ–∂–Ω–æ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å —ç–ª–ª–∏–ø—Ç–∏—á–µ—Å–∫–∏–µ –∫—Ä–∏–≤—ã–µ —Å –ø–æ–º–æ—â—å—é –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞ `EllipticCurve`.

```python
E = EllipticCurve(GF(p), [a,b])
```
–ü–æ—Ä—è–¥–æ–∫ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–ª—É—á–µ–Ω —á–µ—Ä–µ–∑
```python
print(E.order())
```

## –í–æ–ø—Ä–æ—Å 5

> [5] Enter the full factorization of the order of the elliptic curve defined over the finite field F_{p^3}. Follow the same format as in question 2 >

> [5] –í–≤–µ–¥–∏—Ç–µ –ø–æ–ª–Ω—É—é —Ñ–∞–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –ø–æ—Ä—è–¥–∫–∞ —ç–ª–ª–∏–ø—Ç–∏—á–µ—Å–∫–æ–π –∫—Ä–∏–≤–æ–π, –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–π –Ω–∞–¥ –∫–æ–Ω–µ—á–Ω—ã–º –ø–æ–ª–µ–º F_{p^3}. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ—Ç –∂–µ —Ñ–æ—Ä–º–∞—Ç, —á—Ç–æ –∏ –≤ –≤–æ–ø—Ä–æ—Å–µ (2) >


## –†–µ—à–µ–Ω–∏–µ 5


–ó–¥–µ—Å—å –Ω—É–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –≥—Ä—É–ø–ø–æ–π $E(\mathbb{F}_{p^3})$. –ï—Å–ª–∏ –ø–æ–ø—ã—Ç–∞—Ç—å—Å—è –æ–±—ä—è–≤–∏—Ç—å –∫—Ä–∏–≤—É—é —Ç–∞–∫:

```python
E3 = EllipticCurve(GF(p^3), [a,b])
```

—ç—Ç–æ –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –Ω–µ–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ –º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏, –ø–æ—Ç–æ–º—É —á—Ç–æ, –∫–∞–∫ —É–∫–∞–∑–∞–Ω–æ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ SageMath [docs](https://doc.sagemath.org/html/en/reference/finite_rings/sage/rings/finite_rings/finite_field_constructor.html#finite-fields), –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∏–º–µ–Ω–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–µ GF Sage –ø—ã—Ç–∞–µ—Ç—Å—è –≤—ã—á–∏—Å–ª–∏—Ç—å –ø—Å–µ–≤–¥–æ‚Äë–ö–æ–Ω–≤–µ–π–µ–≤—ã –º–Ω–æ–≥–æ—á–ª–µ–Ω—ã, —á—Ç–æ –æ–±—ã—á–Ω–æ –¥–æ—Ä–æ–≥–æ—Å—Ç–æ—è—â–∞—è –∑–∞–¥–∞—á–∞.

> –ï—Å–ª–∏ –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–≥–æ –ø–æ–ª—è –Ω–µ –∑–∞–¥–∞–Ω–æ –∏–º—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π, Sage –ø–æ–¥–±–∏—Ä–∞–µ—Ç –ø–æ–ª–µ –≤ —Å–æ–≤–º–µ—Å—Ç–∏–º—É—é —Ä–µ—à—ë—Ç–∫—É —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π, –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—É—é –ø—Å–µ–≤–¥–æ‚Äë–ö–æ–Ω–≤–µ–π–µ–≤—ã–º–∏ –º–Ω–æ–≥–æ—á–ª–µ–Ω–∞–º–∏.

–∏

> –£—á—Ç–∏—Ç–µ, —á—Ç–æ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –ø—Å–µ–≤–¥–æ‚Äë–ö–æ–Ω–≤–µ–π–µ–≤—ã—Ö –º–Ω–æ–≥–æ—á–ª–µ–Ω–æ–≤ –¥–æ—Ä–æ–≥–æ, –∫–æ–≥–¥–∞ —Å—Ç–µ–ø–µ–Ω—å –≤–µ–ª–∏–∫–∞ –∏ —Å–∏–ª—å–Ω–æ —Å–æ—Å—Ç–∞–≤–Ω–∞. –ï—Å–ª–∏ —É–∫–∞–∑–∞—Ç—å –∏–º—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π, —Ç–æ –≤–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–ª—É—á–∞–π–Ω—ã–π –º–Ω–æ–≥–æ—á–ª–µ–Ω, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≥–æ—Ä–∞–∑–¥–æ –±—ã—Å—Ç—Ä–µ–µ.

–ü–æ—ç—Ç–æ–º—É —Ä–µ—à–µ–Ω–∏–µ ‚Äî –ø–µ—Ä–µ–¥–∞—Ç—å –∏–º—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä GF, –Ω–∞–ø—Ä–∏–º–µ—Ä:

```python
E3 = EllipticCurve(GF(p^3, 'x'), [a,b])
```

–≠—Ç–æ –∑–∞–Ω–∏–º–∞–µ—Ç –ø–∞—Ä—É —Å–µ–∫—É–Ω–¥, —Ç–æ–≥–¥–∞ –ø–æ—Ä—è–¥–æ–∫ –∫—Ä–∏–≤–æ–π $E3$ –±—É–¥–µ—Ç:
```
9547468349770605965573984760817208987986240857800275642666264260062210623470017904319931275058250264223830562439645572562493214488086970563135688265933076141657703804791593446020774169988605421998202682898213433784381043211278976059744771523119218399190407965593665262490269084642700982261912090274007278407746985341700600062580644280196871035164
```
–≠—Ç–æ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –±–æ–ª—å—à–æ–µ —á–∏—Å–ª–æ –¥–ª—è —Ñ–∞–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏. –û–¥–Ω–∞–∫–æ –∫—Ä–∏–≤–∞—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞ –Ω–∞–¥ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º –ø–æ–ª—è $\mathbb{F}_p$, –∏ –ø–æ—ç—Ç–æ–º—É —Å–∞–º–æ  $p$ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ —è–≤–ª—è–µ—Ç—Å—è –¥–µ–ª–∏—Ç–µ–ª–µ–º –ø–æ—Ä—è–¥–∫–∞ $E3$. –ï—Å–ª–∏ –º—ã —è–≤–Ω–æ –∑–Ω–∞–µ–º –ø—Ä–æ—Å—Ç–æ–π –º–Ω–æ–∂–∏—Ç–µ–ª—å –±–æ–ª—å—à–æ–≥–æ —Ü–µ–ª–æ–≥–æ, –º–æ–∂–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –µ–≥–æ –≤ Sage –∫–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ –ø—Ä–æ—Å—Ç–æ–µ:
```python
pari.addprimes(p)
```

–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —ç—Ç–æ–≥–æ –º–µ—Ç–æ–¥–∞ [–∑–¥–µ—Å—å](https://pari.math.u-bordeaux.fr/dochtml/html-stable/Arithmetic_functions.html#addprimes). –ë—É–¥–µ—Ç –ø–æ–Ω—è—Ç–Ω–µ–µ –≤ –¥–µ–π—Å—Ç–≤–∏–∏: 

```python
sage: from Crypto.Util.number import *
sage: p = getPrime(1024) # –ø–æ–ª—É—á–µ–Ω–∏–µ –ø–∞—Ä—Ç–∏–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Å—Ç–æ–≥–æ —á–∏—Å–ª–∞/–≤–µ–∫—Ç–æ—Ä–∞ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã user-defined primes
sage: q = getPrime(1024)
sage: n = p*q
sage: n
20757129878476196263766872240356958683650945798076285374429775626750970675513949330074446501516100612855517734182615205487375158770547675863132057845044511253612104340755258134472492863749974099238393211422482063848956290097603703403564775164108269935134123533832551877277983143057277347519638492514730585441221489703011952662960160030649683727711868449437792977325313522208091595856156628129900905301736295843987380979447190397144712286376614669181013408381064404716330492150142662639295566001441283955619169309869318853752127302884843929101272094587621444078042154214135497915486825032223429010111980881109120894619
sage: factor(n)
```
–æ–±—ã—á–Ω–æ —Ñ–∞–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –±–æ–ª—å—à–æ–≥–æ n –∑–∞–π–º—ë—Ç –≤–µ—á–Ω–æ—Å—Ç—å. –ù–æ –µ—Å–ª–∏ –≤—Ä—É—á–Ω—É—é –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ—Å—Ç—ã–µ —á–∏—Å–ª–∞ p (–∏–ª–∏ q) –≤ —Ç–∞–±–ª–∏—Ü—É –ø–∞—Ä—Ç–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–æ—Å—Ç—ã—Ö, –≤—ã–∑–æ–≤ factor —Å—Ä–∞–∑—É –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —ç—Ç–æ.  –ü—Ä–∏ –≤—ã–∑–æ–≤–µ factor SageMath —Å–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ç–∞–±–ª–∏—Ü—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –ø—Ä–æ—Å—Ç—ã—Ö, –∞ –∑–∞—Ç–µ–º –≤—ã–ø–æ–ª–Ω—è–µ—Ç –æ—Å–Ω–æ–≤–Ω—É—é —Ñ–∞–∑—É —Ñ–∞–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏.

```python
sage: pari.addprimes(p)
[135297421183906417726626566740392626259579894073148661948890956451534112118754812518541726232569467292282889478862196473691620312949705365444531155604964232384414519054467223902773473493544417851262252940216993215948007127456493797866112761691339199411393341226367641871932959447890003835446238132539812721059]
sage: factor(n)
135297421183906417726626566740392626259579894073148661948890956451534112118754812518541726232569467292282889478862196473691620312949705365444531155604964232384414519054467223902773473493544417851262252940216993215948007127456493797866112761691339199411393341226367641871932959447890003835446238132539812721059 * 153418518230746956832407389341510432321776318039049791930350617730834744222389125421305520696017649557031736476686177322840802928919743226100290944901830004530993711798893449524808895430620967209398867996295438442523055241368009393199337777457108938262414406752504285077712759094370202179724398445117658076841
```
–î–ª—è –Ω–∞—à–µ–π –∑–∞–¥–∞—á–∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å p –≤ —Ç–∞–±–ª–∏—Ü—É ‚Äî —ç—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç —Å—Ä–∞–∑—É –ø–æ–ª—É—á–∏—Ç—å —Ñ–∞–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –ø–æ—Ä—è–¥–∫–∞ –∫—Ä–∏–≤–æ–π.

```python
sage: pari.addprimes(p)
[21214334341047589034959795830530169972304000967355896041112297190770972306665257150126981587914335537556050020788061]
sage: factor(E3.order())
2^2 * 7^2 * 21214334341047589034959795830530169972304000967355896041112297190770972306665257150126981587914335537556050020788061 * <large_prime_factor>
```
–≠—Ç–∞ —Ñ–∞–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∏ –±—É–¥–µ—Ç –æ—Ç–≤–µ—Ç–æ–º, —Ñ–æ—Ä–º–∞—Ç –∫–∞–∫ –≤ –≤–æ–ø—Ä–æ—Å–µ 2

## –í–æ–ø—Ä–æ—Å 6

> The final trial awaits. You must uncover the hidden multiplier "d" such that A = d * G.
> ‚öîÔ∏è The chosen base point G has x-coordinate: 10754634945965100597587232538382698551598951191077578676469959354625325250805353921972302088503050119092675418338771
> üîÆ The resulting point A has x-coordinate: 776741307896310549358901148397047715054445374890300753826496778948879054114421829863318830784216542919559209003815

> –ü–æ—Å–ª–µ–¥–Ω–µ–µ –∏—Å–ø—ã—Ç–∞–Ω–∏–µ –∂–¥—ë—Ç. –í—ã –¥–æ–ª–∂–Ω—ã —Ä–∞—Å–∫—Ä—ã—Ç—å —Å–∫—Ä—ã—Ç—ã–π –º–Ω–æ–∂–∏—Ç–µ–ª—å ¬´d¬ª —Ç–∞–∫–æ–π, —á—Ç–æ A = d * G.  
> ‚öîÔ∏è –í—ã–±—Ä–∞–Ω–Ω–∞—è –±–∞–∑–æ–≤–∞—è —Ç–æ—á–∫–∞ G –∏–º–µ–µ—Ç (x‚Äë–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—É): 10754634945965100597587232538382698551598951191077578676469959354625325250805353921972302088503050119092675418338771  
> üîÆ –†–µ–∑—É–ª—å—Ç–∏—Ä—É—é—â–∞—è —Ç–æ—á–∫–∞ A –∏–º–µ–µ—Ç (x‚Äë–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—É): 776741307896310549358901148397047715054445374890300753826496778948879054114421829863318830784216542919559209003815

## –†–µ—à–µ–Ω–∏–µ 6

–î–ª—è —ç—Ç–æ–≥–æ —Å–ª—É—á–∞—è –∏–≥—Ä–æ–∫ –º–æ–∂–µ—Ç –ø—Ä–æ—Å—Ç–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ç–æ—á–∫–∏ –Ω–∞ –∫—Ä–∏–≤–æ–π $E$ –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—å `log(A, G)`, —á—Ç–æ–±—ã —Ä–µ—à–∏—Ç—å –∑–∞–¥–∞—á—É –¥–∏—Å–∫—Ä–µ—Ç–Ω–æ–≥–æ –ª–æ–≥–∞—Ä–∏—Ñ–º–∏—Ä–æ–≤–∞–Ω–∏—è:

```python
sage: G = E.lift_x(10754634945965100597587232538382698551598951191077578676469959354625325250805353921972302088503050119092675418338771)
sage: A = E.lift_x(776741307896310549358901148397047715054445374890300753826496778948879054114421829863318830784216542919559209003815)
sage: %time log(A,G)
CPU times: user 257 ms, sys: 1.82 ms, total: 259 ms
Wall time: 258 ms
10467269628793371276566698866836952927307367226151628920389303503200368737798238832516990930420184955214737647295096
```

>–û–¥–Ω–∞–∫–æ –æ–±—ã—á–Ω–æ ECDLP —Ç—Ä—É–¥–Ω–æ —Ä–µ—à–∏—Ç—å, —Ç–æ–≥–¥–∞ –∫–∞–∫ –∑–¥–µ—Å—å —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –º–Ω–æ–∂–∏—Ç–µ–ª—å –±—ã–ª –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∑–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥. –ü—Ä–∏—á–∏–Ω–∞ –≤ —Ç–æ–º, —á—Ç–æ –∫—Ä–∏–≤–∞—è $E$ —è–≤–ª—è–µ—Ç—Å—è –∞–Ω–æ–º–∞–ª—å–Ω–æ–π: –ø–æ—Ä—è–¥–æ–∫ $E$ —Ä–∞–≤–µ–Ω –ø—Ä–æ—Å—Ç–æ–º—É $p$. –≠—Ç–æ –º–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–∞–∫:

```python
sage: E.order() == p
True
```

–í —Ç–∞–∫–æ–º —Å–ª—É—á–∞–µ ECDLP —Ä–µ—à–∞–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é –∞—Ç–∞–∫–∏ Smart.

–ü–æ—Å–ª–µ –æ—Ç–≤–µ—Ç–∞ –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –≤–æ–ø—Ä–æ—Å –º—ã –Ω–∞–∫–æ–Ω–µ—Ü –ø–æ–ª—É—á–∞–µ–º —Ñ–ª–∞–≥.

–í —Ä–µ—à–µ–Ω–∏–∏ solver.py –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Å–µ—Ç–µ–≤–æ–π —Å–µ—Ä–≤–∏—Å , –∫ –∫–æ—Ç–æ—Ä–æ–º—É –ø–æ –ø–æ—Ä—è–¥–∫—É —á–µ—Ä–µ–∑ pwntools –ø–æ—Å—ã–ª–∞—é—Ç –æ—Ç–≤–µ—Ç—ã –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –≤—ã—à–µ. –ë–µ–∑ pwntools —Å—É—Ç—å –∫–æ–¥–∞ –ø–æ–ª—å–Ω–æ—Å—Ç—å—é —Ç–∞ –∂–µ.